<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ici Orl√©ans - Syst√®me d'affichage</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
      color: #fff;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .container {
      max-width: 1000px;
      width: 100%;
    }
    
    header {
      text-align: center;
      margin-bottom: 50px;
    }
    
    .logo {
      width: 120px;
      height: 120px;
      margin: 0 auto 20px;
      background: #0078d4;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
      box-shadow: 0 10px 30px rgba(0,120,212,0.3);
    }
    
    h1 {
      font-size: 42px;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #0078d4, #4a9eff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .subtitle {
      color: #999;
      font-size: 18px;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }
    
    .card {
      background: #2a2a2a;
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      transition: all 0.3s;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #0078d4, #4a9eff);
    }
    
    .card:hover {
      transform: translateY(-5px);
      border-color: #0078d4;
      box-shadow: 0 15px 40px rgba(0,120,212,0.3);
    }
    
    .card-icon {
      font-size: 48px;
      margin-bottom: 15px;
      display: block;
    }
    
    .card-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 10px;
      color: #fff;
    }
    
    .card-desc {
      color: #999;
      font-size: 14px;
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    .card-link {
      display: inline-block;
      padding: 10px 20px;
      background: #0078d4;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-weight: 600;
      transition: all 0.3s;
    }
    
    .card-link:hover {
      background: #005a9e;
    }
    
    .card.primary {
      grid-column: 1 / -1;
      background: linear-gradient(135deg, #0078d4, #005a9e);
      border: none;
    }
    
    .card.primary::before {
      display: none;
    }
    
    .card.primary .card-title {
      font-size: 24px;
    }
    
    .card.primary .card-desc {
      color: rgba(255,255,255,0.8);
      font-size: 16px;
    }
    
    .card.primary .card-link {
      background: white;
      color: #0078d4;
      font-size: 16px;
      padding: 12px 30px;
    }
    
    .card.primary .card-link:hover {
      transform: scale(1.05);
    }
    
    .status {
      text-align: center;
      padding: 15px;
      background: rgba(45,125,45,0.2);
      border: 1px solid #2d7d2d;
      border-radius: 8px;
      margin-top: 30px;
      color: #4caf50;
    }
    
    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
      .card.primary {
        grid-column: 1;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">üéôÔ∏è</div>
      <h1>ici Orl√©ans</h1>
      <p class="subtitle">Syst√®me d'affichage dynamique</p>
    </header>
    
    <div class="grid">
      <div class="card primary">
        <span class="card-icon">‚öôÔ∏è</span>
        <h2 class="card-title">Configuration Affichage</h2>
        <p class="card-desc">
          Param√©trez l'affichage dynamique : animation logo, bascule auto API/√âv√©nement, dur√©es, th√®me.<br>
          Configuration compl√®te en quelques clics.
        </p>
        <a href="#" onclick="openConfig(event)" class="card-link">Configurer ‚Üí</a>
      </div>
      
      <div class="card">
        <span class="card-icon">üì∫</span>
        <h3 class="card-title">Affichage Public</h3>
        <p class="card-desc">
          Page principale √† projeter.<br>
          Affiche √©missions, √©v√©nements ou programme.
        </p>
        <a href="display.html" class="card-link">Ouvrir</a>
      </div>
      
      <div class="card">
        <span class="card-icon">üìÖ</span>
        <h3 class="card-title">Cr√©er un √©v√©nement</h3>
        <p class="card-desc">
          Interface simplifi√©e pour cr√©er<br>
          votre affiche personnalis√©e.
        </p>
        <a href="event-config.html" class="card-link">Cr√©er</a>
      </div>
      
      <div class="card">
        <span class="card-icon">‚öôÔ∏è</span>
        <h3 class="card-title">Configuration Tech</h3>
        <p class="card-desc">
          Param√®tres avanc√©s, token API,<br>
          rotation des modes, th√®me.
        </p>
        <a href="tech.html" class="card-link">Configurer</a>
      </div>
      
      <div class="card">
        <span class="card-icon">üß™</span>
        <h3 class="card-title">Tests & Diagnostic</h3>
        <p class="card-desc">
          V√©rifier l'API, mode d√©mo,<br>
          voir les donn√©es en temps r√©el.
        </p>
        <a href="test-display.html" class="card-link">Tester</a>
      </div>
      
      <div class="card">
        <span class="card-icon">üìñ</span>
        <h3 class="card-title">Guide d'utilisation</h3>
        <p class="card-desc">
          Documentation compl√®te,<br>
          tutoriels et astuces.
        </p>
        <a href="guide.html" class="card-link">Lire</a>
      </div>
      
      <div class="card">
        <span class="card-icon">üïê</span>
        <h3 class="card-title">Horloge Principale</h3>
        <p class="card-desc">
          Clock OnAir avec chronom√®tre<br>
          et chat messagerie.
        </p>
        <a href="clock.html" class="card-link">Voir</a>
      </div>
    </div>
    
    <!-- Modal de configuration -->
    <div id="configModal" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 9999; overflow-y: auto; padding: 20px;">
      <div style="max-width: 800px; margin: 0 auto; background: #2a2a2a; border-radius: 16px; padding: 30px; position: relative;">
        <button onclick="closeConfig()" style="position: absolute; top: 20px; right: 20px; background: #444; border: none; color: white; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 24px;">√ó</button>
        
        <h2 style="margin-bottom: 30px; font-size: 28px; color: #fff;">‚öôÔ∏è Configuration Affichage</h2>
        
        <!-- Bascule automatique API/√âv√©nement -->
        <div style="background: #333; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
          <h3 style="color: #4a9eff; margin-bottom: 20px; font-size: 20px;">üîÑ Bascule Automatique</h3>
          
          <label style="display: flex; align-items: center; margin-bottom: 20px; cursor: pointer;">
            <input type="checkbox" id="autoSwitchEnabled" style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
            <span style="color: #fff; font-size: 16px;">Activer la rotation API ‚Üí Logo ‚Üí √âv√©nement</span>
          </label>
          
          <div style="margin-bottom: 15px;">
            <label style="display: block; color: #999; margin-bottom: 8px; font-size: 14px;">
              Intervalle de rotation (secondes)
              <span style="color: #666; font-size: 12px;"> - Le logo reste toujours 5s</span>
            </label>
            <input type="number" id="switchInterval" min="5" max="300" value="20" 
                   style="width: 100%; padding: 12px; background: #444; border: 2px solid #555; border-radius: 8px; color: white; font-size: 16px;">
            <small style="color: #666; display: block; margin-top: 5px;">
              Exemple: 20s = API (20s) ‚Üí Logo (5s) ‚Üí √âv√©nement (20s)
            </small>
          </div>
        </div>
        
        <!-- Animation du logo -->
        <div style="background: #333; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
          <h3 style="color: #4a9eff; margin-bottom: 20px; font-size: 20px;">üé¨ Animation Logo</h3>
          
          <div style="margin-bottom: 15px;">
            <label style="display: block; color: #999; margin-bottom: 8px; font-size: 14px;">Dur√©e d'affichage du logo (secondes)</label>
            <input type="number" id="logoDuration" min="3" max="30" value="5" 
                   style="width: 100%; padding: 12px; background: #444; border: 2px solid #555; border-radius: 8px; color: white; font-size: 16px;">
            <small style="color: #666; display: block; margin-top: 5px;">Recommand√©: 5-10 secondes</small>
          </div>
          
          <div style="margin-bottom: 15px;">
            <label style="display: block; color: #999; margin-bottom: 8px; font-size: 14px;">Tagline sous le logo</label>
            <input type="text" id="logoTagline" value="Votre radio locale" maxlength="50"
                   style="width: 100%; padding: 12px; background: #444; border: 2px solid #555; border-radius: 8px; color: white; font-size: 16px;">
            <small style="color: #666; display: block; margin-top: 5px;">Texte affich√© sous le logo</small>
          </div>
        </div>
        
        <!-- Mode d'affichage -->
        <div style="background: #333; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
          <h3 style="color: #4a9eff; margin-bottom: 20px; font-size: 20px;">üì∫ Mode d'affichage</h3>
          
          <div style="margin-bottom: 15px;">
            <label style="display: block; color: #999; margin-bottom: 8px; font-size: 14px;">Mode par d√©faut</label>
            <select id="displayMode" style="width: 100%; padding: 12px; background: #444; border: 2px solid #555; border-radius: 8px; color: white; font-size: 16px;">
              <option value="show">üì° API Radio France (√©mission en direct)</option>
              <option value="event">üìÖ √âv√©nement configur√©</option>
              <option value="nowplaying">üéµ Now Playing (musique)</option>
              <option value="schedule">üìã Programme du jour</option>
            </select>
          </div>
          
          <div style="margin-bottom: 15px;">
            <label style="display: block; color: #999; margin-bottom: 8px; font-size: 14px;">Th√®me visuel</label>
            <select id="displayTheme" style="width: 100%; padding: 12px; background: #444; border: 2px solid #555; border-radius: 8px; color: white; font-size: 16px;">
              <option value="dark">üåô Sombre (recommand√©)</option>
              <option value="light">‚òÄÔ∏è Clair</option>
            </select>
          </div>
          
          <div style="margin-bottom: 15px;">
            <label style="display: block; color: #999; margin-bottom: 8px; font-size: 14px;">Intervalle de rafra√Æchissement (secondes)</label>
            <input type="number" id="refreshInterval" min="10" max="300" value="30" 
                   style="width: 100%; padding: 12px; background: #444; border: 2px solid #555; border-radius: 8px; color: white; font-size: 16px;">
            <small style="color: #666; display: block; margin-top: 5px;">Fr√©quence de mise √† jour des donn√©es API</small>
          </div>
        </div>
        
        <!-- Rotation multi-modes (avanc√©) -->
        <div style="background: #333; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
          <h3 style="color: #4a9eff; margin-bottom: 20px; font-size: 20px;">üîÅ Rotation Multi-Modes (Avanc√©)</h3>
          
          <label style="display: flex; align-items: center; margin-bottom: 20px; cursor: pointer;">
            <input type="checkbox" id="rotationEnabled" style="width: 20px; height: 20px; margin-right: 10px; cursor: pointer;">
            <span style="color: #fff; font-size: 16px;">Activer rotation avanc√©e (d√©sactive la bascule auto ci-dessus)</span>
          </label>
          
          <div id="rotationOptions" style="opacity: 0.5; pointer-events: none;">
            <div style="margin-bottom: 15px;">
              <label style="display: block; color: #999; margin-bottom: 8px; font-size: 14px;">Intervalle de rotation (secondes)</label>
              <input type="number" id="rotationInterval" min="10" max="600" value="60" 
                     style="width: 100%; padding: 12px; background: #444; border: 2px solid #555; border-radius: 8px; color: white; font-size: 16px;">
            </div>
            
            <label style="display: block; color: #999; margin-bottom: 8px; font-size: 14px;">Modes √† inclure dans la rotation</label>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
              <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #444; border-radius: 8px;">
                <input type="checkbox" class="rotation-mode" value="show" checked style="margin-right: 10px;">
                <span style="color: #fff;">üì° API Radio France</span>
              </label>
              <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #444; border-radius: 8px;">
                <input type="checkbox" class="rotation-mode" value="nowplaying" style="margin-right: 10px;">
                <span style="color: #fff;">üéµ Now Playing</span>
              </label>
              <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #444; border-radius: 8px;">
                <input type="checkbox" class="rotation-mode" value="schedule" style="margin-right: 10px;">
                <span style="color: #fff;">üìã Programme</span>
              </label>
              <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #444; border-radius: 8px;">
                <input type="checkbox" class="rotation-mode" value="event" style="margin-right: 10px;">
                <span style="color: #fff;">üìÖ √âv√©nement</span>
              </label>
            </div>
          </div>
        </div>
        
        <!-- Boutons d'action -->
        <div style="display: flex; gap: 15px; margin-top: 30px;">
          <button onclick="saveConfig()" style="flex: 1; padding: 15px; background: linear-gradient(135deg, #0078d4, #4a9eff); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">
            üíæ Enregistrer
          </button>
          <button onclick="resetConfig()" style="padding: 15px 30px; background: #444; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">
            üîÑ R√©initialiser
          </button>
          <button onclick="closeConfig()" style="padding: 15px 30px; background: #555; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">
            Annuler
          </button>
        </div>
        
        <div id="saveMessage" style="margin-top: 20px; padding: 15px; background: #2d7d2d; border-radius: 8px; color: #4caf50; text-align: center; display: none;">
          ‚úÖ Configuration enregistr√©e avec succ√®s !
        </div>
      </div>
    </div>
    
    <div class="status">
      ‚úÖ <strong>Mode d√©mo activ√©</strong> - Le syst√®me fonctionne avec des donn√©es de test.<br>
      <small>Configurez votre token API Radio France dans "Configuration Tech" pour les vraies donn√©es.</small>
    </div>
  </div>
  
  <script>
    // Auto-activer mode d√©mo au premier chargement
    if (!localStorage.getItem('radiofrance_demo_mode')) {
      localStorage.setItem('radiofrance_demo_mode', 'true');
    }
    
    // ============ GESTION CONFIGURATION ============
    
    function openConfig(event) {
      event.preventDefault();
      loadCurrentConfig();
      document.getElementById('configModal').style.display = 'block';
      document.body.style.overflow = 'hidden';
    }
    
    function closeConfig() {
      document.getElementById('configModal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }
    
    function loadCurrentConfig() {
      const saved = localStorage.getItem('display_config');
      let config = {
        mode: 'show',
        theme: 'dark',
        refreshInterval: 30000,
        autoSwitchEventEnabled: true,
        autoSwitchEventInterval: 20000,
        logoDuration: 5000,
        logoTagline: 'Votre radio locale',
        rotationEnabled: false,
        rotationInterval: 60000,
        rotationModes: ['show', 'nowplaying', 'schedule']
      };
      
      if (saved) {
        try {
          config = { ...config, ...JSON.parse(saved) };
        } catch (e) {
          console.error('Erreur chargement config:', e);
        }
      }
      
      // Remplir le formulaire
      document.getElementById('autoSwitchEnabled').checked = config.autoSwitchEventEnabled;
      document.getElementById('switchInterval').value = config.autoSwitchEventInterval / 1000;
      document.getElementById('logoDuration').value = config.logoDuration / 1000;
      document.getElementById('logoTagline').value = config.logoTagline || 'Votre radio locale';
      document.getElementById('displayMode').value = config.mode;
      document.getElementById('displayTheme').value = config.theme;
      document.getElementById('refreshInterval').value = config.refreshInterval / 1000;
      document.getElementById('rotationEnabled').checked = config.rotationEnabled;
      document.getElementById('rotationInterval').value = config.rotationInterval / 1000;
      
      // Rotation modes
      const modeCheckboxes = document.querySelectorAll('.rotation-mode');
      modeCheckboxes.forEach(cb => {
        cb.checked = config.rotationModes.includes(cb.value);
      });
      
      updateRotationUI();
    }
    
    function saveConfig() {
      const rotationModes = Array.from(document.querySelectorAll('.rotation-mode:checked'))
        .map(cb => cb.value);
      
      const config = {
        mode: document.getElementById('displayMode').value,
        theme: document.getElementById('displayTheme').value,
        refreshInterval: parseInt(document.getElementById('refreshInterval').value) * 1000,
        autoSwitchEventEnabled: document.getElementById('autoSwitchEnabled').checked,
        autoSwitchEventInterval: parseInt(document.getElementById('switchInterval').value) * 1000,
        logoDuration: parseInt(document.getElementById('logoDuration').value) * 1000,
        logoTagline: document.getElementById('logoTagline').value || 'Votre radio locale',
        rotationEnabled: document.getElementById('rotationEnabled').checked,
        rotationInterval: parseInt(document.getElementById('rotationInterval').value) * 1000,
        rotationModes: rotationModes.length > 0 ? rotationModes : ['show']
      };
      
      // Sauvegarder
      localStorage.setItem('display_config', JSON.stringify(config));
      
      // Afficher message de confirmation
      const msg = document.getElementById('saveMessage');
      msg.style.display = 'block';
      setTimeout(() => {
        msg.style.display = 'none';
      }, 3000);
      
      // Recharger display.html si ouvert dans un autre onglet
      try {
        if (typeof BroadcastChannel !== 'undefined') {
          const bc = new BroadcastChannel('display_config_channel');
          bc.postMessage({ type: 'config_updated', config });
          bc.close();
        }
      } catch (e) {
        console.log('BroadcastChannel non disponible');
      }
      
      console.log('‚úÖ Configuration sauvegard√©e:', config);
    }
    
    function resetConfig() {
      if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser la configuration par d√©faut ?')) {
        localStorage.removeItem('display_config');
        loadCurrentConfig();
        
        const msg = document.getElementById('saveMessage');
        msg.textContent = 'üîÑ Configuration r√©initialis√©e aux valeurs par d√©faut';
        msg.style.display = 'block';
        setTimeout(() => {
          msg.textContent = '‚úÖ Configuration enregistr√©e avec succ√®s !';
          msg.style.display = 'none';
        }, 3000);
      }
    }
    
    // G√©rer l'activation/d√©sactivation de la rotation avanc√©e
    document.addEventListener('DOMContentLoaded', () => {
      const rotationCheckbox = document.getElementById('rotationEnabled');
      const autoSwitchCheckbox = document.getElementById('autoSwitchEnabled');
      
      if (rotationCheckbox) {
        rotationCheckbox.addEventListener('change', updateRotationUI);
      }
      
      if (autoSwitchCheckbox) {
        autoSwitchCheckbox.addEventListener('change', () => {
          if (autoSwitchCheckbox.checked && rotationCheckbox.checked) {
            rotationCheckbox.checked = false;
            updateRotationUI();
          }
        });
      }
      
      if (rotationCheckbox) {
        rotationCheckbox.addEventListener('change', () => {
          if (rotationCheckbox.checked && autoSwitchCheckbox.checked) {
            autoSwitchCheckbox.checked = false;
          }
          updateRotationUI();
        });
      }
    });
    
    function updateRotationUI() {
      const rotationEnabled = document.getElementById('rotationEnabled').checked;
      const rotationOptions = document.getElementById('rotationOptions');
      
      if (rotationEnabled) {
        rotationOptions.style.opacity = '1';
        rotationOptions.style.pointerEvents = 'auto';
      } else {
        rotationOptions.style.opacity = '0.5';
        rotationOptions.style.pointerEvents = 'none';
      }
    }
    
    // Fermer la modal avec √âchap
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeConfig();
      }
    });
    
    // Afficher les infos de config actuelles dans le status
    function updateStatusInfo() {
      const saved = localStorage.getItem('display_config');
      if (saved) {
        try {
          const config = JSON.parse(saved);
          const statusDiv = document.querySelector('.status');
          
          let statusText = '‚úÖ <strong>Syst√®me configur√©</strong> - ';
          
          if (config.autoSwitchEventEnabled) {
            statusText += `Bascule auto activ√©e (${config.autoSwitchEventInterval/1000}s)`;
          } else if (config.rotationEnabled) {
            statusText += `Rotation multi-modes activ√©e (${config.rotationModes.length} modes)`;
          } else {
            statusText += `Mode fixe: ${getModeLabel(config.mode)}`;
          }
          
          statusText += ` | Logo: ${config.logoDuration/1000}s | Th√®me: ${config.theme}`;
          statusDiv.innerHTML = statusText + '<br><small>Cliquez sur "Configuration Affichage" pour modifier les param√®tres.</small>';
        } catch (e) {
          console.error('Erreur lecture config:', e);
        }
      }
    }
    
    function getModeLabel(mode) {
      const labels = {
        'show': 'üì° API Radio France',
        'event': 'üìÖ √âv√©nement',
        'nowplaying': 'üéµ Now Playing',
        'schedule': 'üìã Programme'
      };
      return labels[mode] || mode;
    }
    
    // Mettre √† jour le statut au chargement
    document.addEventListener('DOMContentLoaded', updateStatusInfo);
  </script>
</body>
</html>
